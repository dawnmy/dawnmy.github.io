<!DOCTYPE html>
<html>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>Calculate the identity of the BWA alignments | Space of a muser</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="Explore data enjoy life">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Calculate the identity of the BWA alignments | Space of a muser">
    <meta name="twitter:description" content="Explore data enjoy life">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Calculate the identity of the BWA alignments | Space of a muser">
    <meta property="og:description" content="Explore data enjoy life">

    
    <meta name="author" content="Danny">
    
    <link rel="stylesheet" href="/css/vno.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    
    <link rel="icon" href="/images/avatar-small.png">
    

    <meta name="generator" content="hexo"/>
    

    <link rel="canonical" href="http://dawnmy.github.io/2017/02/18/Calculate-the-identity-of-the-BWA-alignments/"/><!-- hexo-inject:begin --><!-- hexo-inject:end -->

    
      
</head>

<body class="home-template no-js">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><script src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>

    
<header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/" title="前往 Space of a muser 的主页"><img src="/images/hiking.jpg" width="80" alt="Space of a muser logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage for Space of a muser">Space of a muser</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">Insight</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">Explore data enjoy life</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />

        <div class="navigation-wrapper">
          <div>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="访问博客" class="blog-button">博客</a></li>
            
              <li class="navigation__item"><a href="/favourite">喜欢</a></li>
            
              <li class="navigation__item"><a href="/favourite/time.html">时光机</a></li>
            
              <li class="navigation__item"><a href="/about">关于</a></li>
            
            </ul>
          </nav>
          </div>
          <div>
          <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  

  <!-- Github -->
  

<!-- Stack Overflow -->
        

  <!-- Google Plus -->
  

<!-- Facebook -->

  
<!-- Twitter -->

  



  </ul>
</nav>

          </div>
        </div>

      </div>

    </div>

    <div class="panel-cover--overlay cover-purple"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2017-02-18T19:28:36.000Z" class="post-list__meta--date date">2017-02-18</time> &#8226; <span class="post-meta__tags tags">于&nbsp;
  <a class="tag-link" href="/tags/BWA-aligner/">BWA aligner</a>, <a class="tag-link" href="/tags/NGS/">NGS</a>, <a class="tag-link" href="/tags/SAM-tag-NM/">SAM tag NM</a>, <a class="tag-link" href="/tags/identity/">identity</a>
 </span>
      <span class="page-pv">
      &nbsp;阅读&nbsp;<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>
      </span> 
   
    </div>
    <h1 class="post-title">Calculate the identity of the BWA alignments</h1>
  </header>

  <section class="post">
    <p>Since BWA does not report the similarity of the read to reference, we can use the edit distance tag “NM” to retrieve the information regarding the difference between read and reference on sequence. Afterwards, we are able to calculate the identity using:</p>
<p>$$identity = \frac{edit\ distance}{read\ length}$$</p>
<p>Here it a script using AWk to compute the identity and count the number of alignments mapped to “EamGingi” with identity above 97%.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">for file in *.bam;</div><div class="line">do </div><div class="line">	samtools view -h -F4 $file| \</div><div class="line">	awk -F&quot;\t&quot; -v maxpct=0.03 &apos;NF&gt;=11&amp;&amp;$3==&quot;EamGingi&quot;</div><div class="line">	&#123;</div><div class="line">		nm=gensub(/.*\tNM:i:([0-9]+)\t.*/, &quot;\\1&quot;, &quot;g&quot;, $0);nmr=nm/length($10);</div><div class="line">		if(nmr&lt;=maxpct)</div><div class="line">		&#123;</div><div class="line">		print $1, $12,$13, nm</div><div class="line">		&#125;</div><div class="line">	&#125;&apos;|wc -l;</div><div class="line">done</div></pre></td></tr></table></figure>

  </section>

</article>
<section class="read-more">
           
    
               
            <div class="read-more-item">
                <span class="read-more-item-dim">最近的文章</span>
                <h2 class="post-list__post-title post-title"><a href="/2017/02/28/Surival-analysis-using-R/" title="Surival analysis using R">Surival analysis using R</a></h2>
                <!-- p class="excerpt">
                
                以下代码参考生信技能树论坛
12345678910111213141516171819rm(list=ls())setwd(&#39;./TCGA&#39;)###读取自己的TCGA数据dat=read.csv(&#39;3expforRsuoxiao.csv&#39;,header =TRUE,row.names= 1,sep 
                &hellip;
                </p -->
                <div class="post-list__meta"><time datetime="2017-02-28T21:14:25.000Z" class="post-list__meta--date date">2017-02-28</time> &#8226; <span class="post-list__meta--tags tags">于&nbsp;
  <a class="tag-link" href="/tags/TCGA/">TCGA</a>
</span><a class="btn-border-small" href="/2017/02/28/Surival-analysis-using-R/">继续阅读</a></div>
                           
            </div>
        
        
               
            <div class="read-more-item">
                <span class="read-more-item-dim">更早的文章</span>
                <h2 class="post-list__post-title post-title"><a href="/2016/10/24/Plot-heatmaap-with-side-color-indicating-the-class-of-variables/" title="Plot heatmaap with side color indicating the class of variables">Plot heatmaap with side color indicating the class of variables</a></h2>
                <!-- p class="excerpt">
                
                Sometimes, we need to make heatmaps for the matrix data with class information of categorical variables. In this case, we may want to use side color t
                &hellip;
                </p -->
                <div class="post-list__meta"><time datetime="2016-10-24T20:40:00.000Z" class="post-list__meta--date date">2016-10-24</time> &#8226; <span class="post-list__meta--tags tags">于&nbsp;
  <a class="tag-link" href="/tags/Python/">Python</a>, <a class="tag-link" href="/tags/heatmap/">heatmap</a>, <a class="tag-link" href="/tags/seaborn/">seaborn</a>, <a class="tag-link" href="/tags/sidecolor/">sidecolor</a>
</span><a class="btn-border-small" href="/2016/10/24/Plot-heatmaap-with-side-color-indicating-the-class-of-variables/">继续阅读</a></div>
                       
            </div>
        
     
   
   
  
</section>


            
<section class="post-comments">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      var disqus_shortname = 'dreamcatcher-1'; 
      
  var disqus_identifier = '/2017/02/18/Calculate-the-identity-of-the-BWA-alignments/';
  var disqus_title = 'Calculate the identity of the BWA alignments';
  var disqus_url = 'http://dawnmy.github.io/2017/02/18/Calculate-the-identity-of-the-BWA-alignments/';
  

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          //dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
          dsq.src = 'https://a.disquscdn.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

            <footer class="footer">
    <span class="footer__copyright">
        本站点采用 <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>
    </span>
    <span class="footer__copyright">
        基于 <a href="http://hexo.io">Hexo</a> 搭建，感谢 <a href="https://pages.github.com/">GitHub Pages</a> 提供免费的托管服务
    </span>
    <span class="footer__copyright">
        本站使用 <a href="https://github.com/monniya/hexo-theme-new-vno ">hexo-theme-new-vno</a> 主题,
        修改自 <a href="https://github.com/lenbo-ma/hexo-theme-vno" target="_blank">Vno</a>, 原创出自<a href="http://github.com/onevcat/vno" target="_blank">onevcat</a>
    </span>
</footer>

        </div>
    </div>

    

     
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-44649121-2', 'auto');
	ga('send', 'pageview');
</script>

    


    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
    
    </script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
    
</body>
</html>
