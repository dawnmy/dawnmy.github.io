<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="A another place for data science"><title>Plot heatmaap with side color indicating the class of variables | Space of a muser</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.1.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Plot heatmaap with side color indicating the class of variables</h1><a id="logo" href="/.">Space of a muser</a><p class="description">Insight, epiphany</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Plot heatmaap with side color indicating the class of variables</h1><div class="post-meta">Oct 24, 2016<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2016/10/24/Plot-heatmaap-with-side-color-indicating-the-class-of-variables/" href="/2016/10/24/Plot-heatmaap-with-side-color-indicating-the-class-of-variables/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>Sometimes, we need to make heatmaps for the matrix data with class information of categorical variables. In this case, we may want to use side color to mark the classes. Since neither matplotlib nor seaborn offer such functionality directly, we have to implement it in an indirect way. Here is some code snippets from <a href="http://stackoverflow.com/questions/27988846/how-to-express-classes-on-the-axis-of-a-heatmap-in-seaborn" target="_blank" rel="external">Stack Overflow</a> with a bit change to achieve this requirement (The original code does not work for me, so I did some change).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">%matplotlib inline</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div><div class="line">sns.set(font=<span class="string">"Arial"</span>)</div><div class="line"></div><div class="line"><span class="comment"># Load the brain networks example dataset</span></div><div class="line">df = sns.load_dataset(<span class="string">"brain_networks"</span>, header=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], index_col=<span class="number">0</span>)</div><div class="line"></div><div class="line"><span class="comment"># Select a subset of the networks</span></div><div class="line">used_networks = [<span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>]</div><div class="line">used_columns = (df.columns.get_level_values(<span class="string">"network"</span>)</div><div class="line">                          .astype(int)</div><div class="line">                          .isin(used_networks))</div><div class="line">df = df.loc[:, used_columns]</div><div class="line"><span class="comment"># Create a custom palette to identify the networks</span></div><div class="line">network_pal = sns.cubehelix_palette(len(used_networks),</div><div class="line">                                    light=<span class="number">.9</span>, dark=<span class="number">.1</span>, reverse=<span class="keyword">True</span>,</div><div class="line">                                    start=<span class="number">1</span>, rot=<span class="number">-2</span>)</div><div class="line">network_lut = dict(zip(map(str, used_networks), network_pal))</div><div class="line"></div><div class="line"><span class="comment"># Convert the palette to vectors that will be drawn on the side of the matrix</span></div><div class="line">network_labels = df.columns.get_level_values(<span class="string">"network"</span>)</div><div class="line">network_colors = pd.Series(network_labels, index=df.columns).map(network_lut)</div><div class="line"></div><div class="line"><span class="comment"># Create a custom colormap for the heatmap values</span></div><div class="line">cmap = sns.diverging_palette(h_neg=<span class="number">210</span>, h_pos=<span class="number">350</span>, s=<span class="number">90</span>, l=<span class="number">30</span>, as_cmap=<span class="keyword">True</span>)</div><div class="line"></div><div class="line"><span class="comment"># Draw the full plot</span></div><div class="line">g = sns.clustermap(df.corr(),</div><div class="line"></div><div class="line">                  <span class="comment"># Turn off the clustering</span></div><div class="line">                  row_cluster=<span class="keyword">False</span>, col_cluster=<span class="keyword">False</span>,</div><div class="line"></div><div class="line">                  <span class="comment"># Add colored class labels</span></div><div class="line">                  row_colors=network_colors, col_colors=network_colors,</div><div class="line"></div><div class="line">                  <span class="comment"># Make the plot look better when many rows/cols</span></div><div class="line">                  linewidths=<span class="number">0</span>, xticklabels=<span class="keyword">False</span>, yticklabels=<span class="keyword">False</span>)</div><div class="line"></div><div class="line"><span class="comment"># Draw the legend bar for the classes                 </span></div><div class="line"><span class="keyword">for</span> label <span class="keyword">in</span> network_labels.unique():</div><div class="line">    g.ax_col_dendrogram.bar(<span class="number">0</span>, <span class="number">0</span>, color=network_lut[label],</div><div class="line">                            label=label, linewidth=<span class="number">0</span>)</div><div class="line">g.ax_col_dendrogram.legend(loc=<span class="string">"center"</span>, ncol=<span class="number">5</span>)</div><div class="line"></div><div class="line"><span class="comment"># Adjust the postion of the main colorbar for the heatmap</span></div><div class="line">g.cax.set_position([<span class="number">.97</span>, <span class="number">.2</span>, <span class="number">.03</span>, <span class="number">.45</span>])</div></pre></td></tr></table></figure>
<p><img src="/content/images/heatmap_sidecolor.png" alt="Heatmap"></p>
</div><script type="text/javascript" src="/js/share.js?v=0.1.0" async></script><a data-url="http://dawnmy.github.io/2016/10/24/Plot-heatmaap-with-side-color-indicating-the-class-of-variables/" data-id="cizbnxab30003yn9k1mg79w93" class="article-share-link">Share</a><div class="tags"><a href="/tags/Python/">Python</a><a href="/tags/seaborn/">seaborn</a><a href="/tags/heatmap/">heatmap</a><a href="/tags/sidecolor/">sidecolor</a></div><div class="post-nav"><a href="/2017/02/18/Calculate-the-identity-of-the-BWA-alignments/" class="pre">Calculate the identity of the BWA alignments</a><a href="/2016/10/15/Some-tips-for-pandas-usage/" class="next">Some useful tips for pandas</a></div><div id="disqus_thread"><script>var disqus_shortname = 'dreamcatcher-1';
var disqus_identifier = '2016/10/24/Plot-heatmaap-with-side-color-indicating-the-class-of-variables/';
var disqus_title = 'Plot heatmaap with side color indicating the class of variables';
var disqus_url = 'http://dawnmy.github.io/2016/10/24/Plot-heatmaap-with-side-color-indicating-the-class-of-variables/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//dreamcatcher-1.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://dawnmy.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/pandas/" style="font-size: 15px;">pandas</a> <a href="/tags/NGS/" style="font-size: 15px;">NGS</a> <a href="/tags/identity/" style="font-size: 15px;">identity</a> <a href="/tags/SAM-tag-NM/" style="font-size: 15px;">SAM tag NM</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/seaborn/" style="font-size: 15px;">seaborn</a> <a href="/tags/BWA-aligner/" style="font-size: 15px;">BWA aligner</a> <a href="/tags/matplotlib/" style="font-size: 15px;">matplotlib</a> <a href="/tags/jupyter/" style="font-size: 15px;">jupyter</a> <a href="/tags/heatmap/" style="font-size: 15px;">heatmap</a> <a href="/tags/sidecolor/" style="font-size: 15px;">sidecolor</a> <a href="/tags/data-process/" style="font-size: 15px;">data process</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/02/18/Calculate-the-identity-of-the-BWA-alignments/">Calculate the identity of the BWA alignments</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/24/Plot-heatmaap-with-side-color-indicating-the-class-of-variables/">Plot heatmaap with side color indicating the class of variables</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/15/Some-tips-for-pandas-usage/">Some useful tips for pandas</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/Taxonomy-tree-constructio-and-visualization/">Taxonomy tree constructio and visualization</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/09/Data-visualization-with-Python/">Data visualization with Python</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/05/Python-module-bs4/">Python module bs4</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/05/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//dreamcatcher-1.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="http://scikit-learn.org/stable/" title="scikit-learn" target="_blank">scikit-learn</a><ul></ul><a href="https://d3js.org" title="D3.js" target="_blank">D3.js</a><ul></ul><a href="http://www.chartjs.org/docs/" title="Chart.js" target="_blank">Chart.js</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Space of a muser.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.1.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.1.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.1.0"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-44649121-2','auto');ga('send','pageview');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.1.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.1.0"></script></div></body></html>